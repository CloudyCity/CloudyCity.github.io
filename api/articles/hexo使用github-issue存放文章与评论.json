{"title":"hexo使用github issue存放文章与评论","uid":"f4794d5716996e12dfb018f0413b5642","slug":"hexo使用github-issue存放文章与评论","date":"2019-02-14T07:32:14.000Z","updated":"2021-06-04T10:30:25.046Z","comments":true,"path":"api/articles/hexo使用github-issue存放文章与评论.json","cover":"https://i.imgur.com/P2E0Xkw.jpg","content":"<p><code>Hexo</code>默认文章存放于<code>source</code>分支，没有评论系统，不过都可以通过插件进行扩展。本文介绍如何将<code>hexo</code>的文章与评论存放于Github Issue中（issue内容为博客内容，issue评论为博客评论）。</p>\n<span id=\"more\"></span>\n\n<h2 id=\"使用github-issue存放文章\"><a href=\"#使用github-issue存放文章\" class=\"headerlink\" title=\"使用github issue存放文章\"></a>使用github issue存放文章</h2><p>这种方案主要优点是可以直接使用GitHub的图床。<br><em><strong>注意: 19年10月开始<code>githubusercontent.com</code>域名被墙，需要科学才能看到图片</strong></em></p>\n<h3 id=\"安装插件\"><a href=\"#安装插件\" class=\"headerlink\" title=\"安装插件\"></a>安装插件</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span> hexo-migrator-github-issue --save<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<h3 id=\"新建issue文章\"><a href=\"#新建issue文章\" class=\"headerlink\" title=\"新建issue文章\"></a>新建issue文章</h3><p><img src=\"https://user-images.githubusercontent.com/17662451/52760542-daea1d80-304a-11e9-88e6-b8a479c359ea.png\" alt=\"qq 20190214112539\"></p>\n<p>使用GitHub图床非常简单，把图片文件拖到编辑框就行了~</p>\n<h3 id=\"导入文章\"><a href=\"#导入文章\" class=\"headerlink\" title=\"导入文章\"></a>导入文章</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo migrate github-issue 你的Github用户名/你存放hexo的仓库名<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>例如<br><img src=\"https://user-images.githubusercontent.com/17662451/52893713-7b227c80-31da-11e9-910c-d57b2e68227b.png\" alt=\"qq 20190216110245\"><br>然后生成部署即可。</p>\n<h3 id=\"插件扩展\"><a href=\"#插件扩展\" class=\"headerlink\" title=\"插件扩展\"></a>插件扩展</h3><p>该插件会根据issue的label为文章生成标签，如果要想生成分类和置顶参数，需要做一些修改。</p>\n<p>我提了一个<a href=\"https://github.com/Yikun/hexo-migrator-github-issue/pull/4\">PR</a>还没通过，这里直接使用我fork的分支替换。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\"><span class=\"token function\">curl</span> -fsSL https://raw.githubusercontent.com/CloudyCity/hexo-migrator-github-issue/master/index.js <span class=\"token operator\">></span> node_modules/hexo-migrator-github-issue/index.js<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><img src=\"https://user-images.githubusercontent.com/17662451/71967884-ee900b00-323e-11ea-9f72-9be8899eee03.jpg\" alt=\"Xnip2020-01-08_17-46-56\"></p>\n<h2 id=\"使用github-issue存放评论\"><a href=\"#使用github-issue存放评论\" class=\"headerlink\" title=\"使用github issue存放评论\"></a>使用github issue存放评论</h2><h3 id=\"安装插件-1\"><a href=\"#安装插件-1\" class=\"headerlink\" title=\"安装插件\"></a>安装插件</h3><p>Next主题自带gitment，主文件是<code>/themes/next/source/js/src/gitment.browser.js</code>。</p>\n<p>如果是其他主题，需要安装<code>gitment</code>，主文件是<code>/node_modules/gitment/dist/gitment.browser.js</code>。</p>\n<pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ <span class=\"token function\">npm</span> <span class=\"token function\">install</span> gitment --save<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"创建授权应用\"><a href=\"#创建授权应用\" class=\"headerlink\" title=\"创建授权应用\"></a>创建授权应用</h3><p><img src=\"https://user-images.githubusercontent.com/17662451/52766577-88b4f680-3062-11e9-8750-65328503bfa5.png\" alt=\"qq 20190214114441\"><br><a href=\"https://github.com/settings/applications/new\">点击这里</a>创建，名称随意，两个url都填hexo博客的url，创建完成就得到应用ID和密钥。</p>\n<h3 id=\"创建新仓库\"><a href=\"#创建新仓库\" class=\"headerlink\" title=\"创建新仓库\"></a><del>创建新仓库</del></h3><p><del>在GitHub中创建一个新仓库，其issue将用于存放评论。</del></p>\n<h3 id=\"配置\"><a href=\"#配置\" class=\"headerlink\" title=\"配置\"></a>配置</h3><p>在Next主题的配置文件<code>_config.yaml</code>中更改以下配置</p>\n<pre class=\"line-numbers language-yaml\" data-language=\"yaml\"><code class=\"language-yaml\"><span class=\"token key atrule\">gitment</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">enable</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">true</span>\n    <span class=\"token key atrule\">githubID</span><span class=\"token punctuation\">:</span> 你的github用户名\n    <span class=\"token key atrule\">repo</span><span class=\"token punctuation\">:</span> 博客所在仓库\n    <span class=\"token key atrule\">ClientID</span><span class=\"token punctuation\">:</span> 应用ID\n    <span class=\"token key atrule\">ClientSecret</span><span class=\"token punctuation\">:</span> 密钥\n    <span class=\"token key atrule\">lazy</span><span class=\"token punctuation\">:</span> <span class=\"token boolean important\">false</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"修改CORS转发代理\"><a href=\"#修改CORS转发代理\" class=\"headerlink\" title=\"修改CORS转发代理\"></a><del>修改CORS转发代理</del></h3><pre class=\"line-numbers language-JavaScript\" data-language=\"JavaScript\"><code class=\"language-JavaScript\">_utils.http.post(&#39;https:&#x2F;&#x2F;gh-oauth.imsun.net&#39;, &#123;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>原作者提供的转发服务目前正常，无需更换</p>\n<h3 id=\"插件修改\"><a href=\"#插件修改\" class=\"headerlink\" title=\"插件修改\"></a>插件修改</h3><p>此插件原本是使用另一个仓库存放评论，现在的需求是用博客所在仓库的对应文章issue中存放评论，需要修改<code>loadMeta()</code>，让插件使用<code>id</code>获取issue。</p>\n<p>这里使用<code>hexo-migrator-github-issue</code>作者<code>Yikun</code>fork的分支，用<code>webpack</code>打包，覆盖<code>gitment</code>主文件。</p>\n<p><code>Next</code>主题可参考本博客的<a href=\"https://github.com/CloudyCity/CloudyCity.github.io/blob/source/themes/next/source/js/src/gitment.browser.js\">gitment.browser.js</a></p>\n<p>非<code>Next</code>主题可参考我写的替换脚本<a href=\"https://github.com/CloudyCity/CloudyCity.github.io/blob/source/gitment.sh\">gitment.sh</a></p>\n<h3 id=\"主题修改\"><a href=\"#主题修改\" class=\"headerlink\" title=\"主题修改\"></a>主题修改</h3><p>这里使用的是Next主题，需要修改三个模板文件，将<code>hexo-migrator-github-issue</code>插件获取到的<code>issue-number</code>作为<code>id</code>，供<code>gitment</code>插件中的<code>loadMeta()</code>使用。</p>\n<ol>\n<li><code>\\themes\\next\\layout\\_partials\\comments\\gitment.swig</code></li>\n<li><code>\\themes\\next\\layout\\_script\\comments\\gitment.swig</code></li>\n<li><code>\\themes\\next\\layout\\_third-party\\comments\\gitment.swig</code></li>\n</ol>\n<pre class=\"line-numbers language-javascript\" data-language=\"javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">&#123;</span><span class=\"token operator\">%</span> <span class=\"token keyword\">if</span> theme<span class=\"token punctuation\">.</span>gitment<span class=\"token punctuation\">.</span>enable <span class=\"token operator\">%</span><span class=\"token punctuation\">&#125;</span>\n     <span class=\"token punctuation\">&#123;</span><span class=\"token operator\">%</span> <span class=\"token keyword\">set</span> id <span class=\"token operator\">=</span> page<span class=\"token punctuation\">.</span>number <span class=\"token operator\">%</span><span class=\"token punctuation\">&#125;</span>\n     <span class=\"token punctuation\">&#123;</span><span class=\"token operator\">%</span> <span class=\"token keyword\">set</span> owner <span class=\"token operator\">=</span> theme<span class=\"token punctuation\">.</span>gitment<span class=\"token punctuation\">.</span>githubID <span class=\"token operator\">%</span><span class=\"token punctuation\">&#125;</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>可以将主题加入版本控制，更换机器后就不需要再操作一遍，不过也会导致<code>gitment</code>的密钥泄漏:(</p>\n<h2 id=\"最后\"><a href=\"#最后\" class=\"headerlink\" title=\"最后\"></a>最后</h2><p>最终效果参照<a href=\"https://github.com/CloudyCity/CloudyCity.github.io/issues/16\">本文章对应issue</a></p>\n<p>如果大家觉得上面两个插件好用的话可以去给插件的项目点个星支持开发者哦~<br><a href=\"https://github.com/Yikun/hexo-migrator-github-issue\">hexo-migrator-github-issue</a><br><a href=\"https://github.com/imsun/gitment\">gitment</a></p>\n","text":"Hexo默认文章存放于source分支，没有评论系统，不过都可以通过插件进行扩展。本文介绍如何将hexo的文章与评论存放于Github Issue中（issue内容为博客内容，issue评论为博客评论）。 使用github issue存放文章这种方案主要优点是可以直接使用GitH...","link":"","photos":[],"count_time":{"symbolsCount":"1.9k","symbolsTime":"2 mins."},"categories":[{"name":"新手村","slug":"新手村","count":7,"path":"api/categories/新手村.json"}],"tags":[{"name":"hexo","slug":"hexo","count":5,"path":"api/tags/hexo.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8github-issue%E5%AD%98%E6%94%BE%E6%96%87%E7%AB%A0\"><span class=\"toc-text\">使用github issue存放文章</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6\"><span class=\"toc-text\">安装插件</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%96%B0%E5%BB%BAissue%E6%96%87%E7%AB%A0\"><span class=\"toc-text\">新建issue文章</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AF%BC%E5%85%A5%E6%96%87%E7%AB%A0\"><span class=\"toc-text\">导入文章</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%8F%92%E4%BB%B6%E6%89%A9%E5%B1%95\"><span class=\"toc-text\">插件扩展</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8github-issue%E5%AD%98%E6%94%BE%E8%AF%84%E8%AE%BA\"><span class=\"toc-text\">使用github issue存放评论</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6-1\"><span class=\"toc-text\">安装插件</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BA%E6%8E%88%E6%9D%83%E5%BA%94%E7%94%A8\"><span class=\"toc-text\">创建授权应用</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E5%88%9B%E5%BB%BA%E6%96%B0%E4%BB%93%E5%BA%93\"><span class=\"toc-text\">创建新仓库</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E9%85%8D%E7%BD%AE\"><span class=\"toc-text\">配置</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%BF%AE%E6%94%B9CORS%E8%BD%AC%E5%8F%91%E4%BB%A3%E7%90%86\"><span class=\"toc-text\">修改CORS转发代理</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%8F%92%E4%BB%B6%E4%BF%AE%E6%94%B9\"><span class=\"toc-text\">插件修改</span></a></li><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E4%B8%BB%E9%A2%98%E4%BF%AE%E6%94%B9\"><span class=\"toc-text\">主题修改</span></a></li></ol></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E6%9C%80%E5%90%8E\"><span class=\"toc-text\">最后</span></a></li></ol>","author":{"name":"CloudyCity","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/17662451?s=400&u=643d94296b79c5e8424a2177fc4609a5e0ebeae0&v=4","link":"/","description":"拖延并发强迫症懒癌晚期患者","socials":{"github":"https://github.com/CloudyCity","twitter":"","stackoverflow":"https://stackoverflow.com/users/9827779/cloudycity","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://b23.tv/MK4nKb"},"steam":{"icon":"/svg/steam.svg","link":"https://steamcommunity.com/id/cloudycity/home/"}}}},"mapped":true,"prev_post":{"title":"Laravel5.2 DB Builder 子查询的优雅写法","uid":"1d95107ced836961e9639f49026d155a","slug":"Laravel5-2-DB-Builder-子查询的优雅写法","date":"2019-02-25T03:42:38.000Z","updated":"2021-06-04T10:30:25.046Z","comments":true,"path":"api/articles/Laravel5-2-DB-Builder-子查询的优雅写法.json","cover":"https://cdn.educba.com/academy/wp-content/uploads/2020/05/Laravel-Query-Builder.jpg","text":"Laravel5.2的DB Builder还没有fromSub()与joinSub()，Sql涉及子查询时，比较优雅的写法是利用toSql()与mergeBindings()。 FromSELECT * FROM ( SELECT * FROM t1 WHERE c1 = xxx...","link":"","photos":[],"count_time":{"symbolsCount":983,"symbolsTime":"1 mins."},"categories":[{"name":"php","slug":"php","count":12,"path":"api/categories/php.json"}],"tags":[{"name":"laravel","slug":"laravel","count":9,"path":"api/tags/laravel.json"}],"author":{"name":"CloudyCity","slug":"blog-author","avatar":"https://avatars.githubusercontent.com/u/17662451?s=400&u=643d94296b79c5e8424a2177fc4609a5e0ebeae0&v=4","link":"/","description":"拖延并发强迫症懒癌晚期患者","socials":{"github":"https://github.com/CloudyCity","twitter":"","stackoverflow":"https://stackoverflow.com/users/9827779/cloudycity","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"bilibili":{"icon":"/svg/bilibili.svg","link":"https://b23.tv/MK4nKb"},"steam":{"icon":"/svg/steam.svg","link":"https://steamcommunity.com/id/cloudycity/home/"}}}}},"next_post":{}}